{% extends "members/u_base.html" %}
{% load imagetags %}

{% block sub-title %}Organization | {% endblock %}

{% block style %}
{% endblock %}

{% block content %}
<h3 class='oswald' style='text-align: center;'>{{ action|title }} {{ organization.name}} Member</h3>

<form class='org-form' method="POST" action="." enctype="multipart/form-data">
	<input type="hidden" name="action" value="save"/>
	<input type='hidden' name='org_id' value="{{ organization.id }}">
	<input type='hidden' id='member_id' name='member_id' value=''  />
	<table>
		<tr>
			<td class='org-label'>
				User
			</td>
			<td>
				{% if member %}
					<input name='full_name' readonly value='{{ member.user.get_full_name }}' />
				{% else %}
					<input class='username_input' id="id_username" name="username"/>
				{% endif %}
			</td>
			<td class='pf-error'>
				{{ form.username.errors }}
			</td>
		</tr>
		<tr>
			<td class='org-label'>
				Title
			</td>
			<td>
				{{ form.title }}
			</td>
			<td class='pf-error'>
				{{ form.title.errors }}
			</td>
		</tr>
		<tr>
			<td class='org-label'>
				Start Date
			</td>
			<td>
				{{ form.start_date }}
			</td>
			<td class='pf-error'>
				{{ form.start_date.error }}
			</td>
		</tr>
		<tr>
			<td class='org-label'>
				End Date
			</td>
			<td>
				{{ form.end_date }}
			</td>
			<td class='pf-error'>
				{{ form.end_date.errors }}
			</td>
		</tr>
	</table>
	<input class='btn' type="submit" value="Save"/>
	<input class='btn' type="button" value="Cancel" onclick="location.href='{% url 'member_org_view' organization.id %}'"/>
	{% csrf_token %}
</form>

{% endblock %}

{% block extrajs %}
<script>
	$(document).ready(function() {
		if ('{{ action }}' == 'edit') {
			$('#member_id').val('{{ member.id}}');
		} else {
			$('#member_id').remove();
		}
	});

	(function() {
		$('.username_input').autocomplete({
			source: "{% url 'json_user_search' %}",
			minLength: 2,
		})
	})();
</script>
{% endblock %}
