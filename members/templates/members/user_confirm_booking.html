{% extends 'members/u_base.html' %}

{% block sub-title %}Confirm Booking | {% endblock %}

{% block content %}
  <div id='booking_form'>
    <form enctype="multipart/form-data" action='.' method='POST'>
      <h4>Confirm Booking</h4>
      <p style='text-align:center;'>
        Reminder: Make sure you include your setup and breakdown time in your reservation time.
      </p>
      <table>
        <tr>
          <td>Booking For:</td>
          <td><input value='{{ user.first_name }} {{ user.last_name }}' readonly /></td>
        </tr>
        <tr>
          <td id='room'>Room:</td>
          <td><input value='{{ room }}' readonly  /></td>
          <td>{{ booking_form.room.errors }}</td>
        </tr>
        <tr>
          <td>Date:</td>
          <td>
            <input type="date" name="date" value='{{ date }}' class="datepicker col s4 offset-s4" id='booking-date' >
          </td>
        </tr>
        <tr>
          <table class='cal-table'>
            <thead>
              {% for hour in hours %}
                {% if forloop.counter0|divisibleby:2 %}
                  <th class="rotate"><div><span>
                    {{ hour }}
                  </div></span></th>
                {% else %}
                  <th></th>
                {% endif %}
              {% endfor %}
            </thead>
            <tr>
              {% for id in ids %}
                {% for here, reservations in reserved.items %}
                  {% if here == room %}
                    {% if id in reservations %}
                      <td class='cal-box reserved' id='hour-{{ id }}'>
                      </td>
                    {% elif id in search_block %}
                      <td class='cal-box searched' id='hour-{{ id }}'></td>
                    {% else %}
                      <td class='cal-box available' id='hour-{{ id }}'>
                      </td>
                    {% endif %}
                  {% endif %}
                {% endfor %}
              {% endfor %}
            </tr>
          </table>
        </tr>
        <tr>
          <td>From:</td>
          <td>
            <input type='time' step=900 name='start' value='{{ start }}'/>
          </td>
        </tr>
        <tr>
          <td>To:</td>
          <td><input type='time' step=900 name='end' value='{{ end }}'/></td>
        </tr>
        <tr>
          <td>Description:</td>
          <td><input type='text' name='description' id='confirm_desc' placeholder='O.N. Team Meeting'/></td>
          <td>{{ booking_form.description.errors }}</td>
        </tr>
        <tr>
          <td>Is this a public event?</td>
          <td><select class='browser-default input-field col s2' name='public_bool' id='publicly_view'>
            <option value="" disabled selected></option>
            <option value="False">No</option>
            <option value="True">Yes</option>
          </select></td>
          <td>{{ booking_form.publicly_viewable.errors }}</td>
        </tr>
      </table>
      <button type='submit' class='btn' id='confirm-btn'>Confirm</button>
      {% csrf_token %}
    </form>
  </div>
{% endblock %}

{% block extrajs %}
  <script>
    $(document).ready(function() {
      $('.datepicker').pickadate({
        selectMonths: true,
        selectYears: 3,
        format: 'yyyy-mm-dd'
      });

      $('.cal-box').on('click', function() {
        // if the div has class of reserved, throw error

        // if box has class of searched, adjust time accordingly

        // if box has class of available, adjust time and change class

        // update time values on the clicks
      });
    });
  </script>
{% endblock %}
