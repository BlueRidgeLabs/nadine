{% extends "members/u_base.html" %}
{% load imagetags %}

{% block sub-title %}Organization | {{ organization.name }} | {% endblock %}

{% block style %}
{% endblock %}

{% block content %}
<h2>{{ organization.name }}</h2>

<dl>[
	<dd><a href="{% url 'member_org_list' %}">view all</a></dd>

	{% if organizaiton.locked %}
		<dd>locked</dd>
	{% else %}
		<dd>unlocked</dd>
	{% endif %}

	{% if request.user.is_staff %}
		<dd><a href="{{ organization.admin_url }}">admin</a></dd>
	{% endif %}

	{% if can_edit %}
		<dd><a href="{% url 'member_org_edit' organization.id %}">edit details</a></dd>
	{% endif %}
]</dl>

{% if organization.photo %}
	 <a href="{{ organization.photo.url }}"><img src="{{ organization.photo.url|fit_image:"170x170" }}"></a>
{% endif %}

{% if organization.bio %}
	<h3>Bio</h3>
	<p style="margin:2em;">{{ organization.bio }} </p>
{% endif %}

<h3>Organization Members</h3>
<table>
	<tr>
		<th>Member</th>
		<th>Title</th>
		<th>From</th>
		<th>To</th>
		<th>Lead</th>
		<th>Admin</th>
		<th>Active</th>
		<th>Action</th>
	</tr>
	{% for m in members %}
		<form id="org_mem_{{m.id}}" action="{% url 'member_org_member' organization.id %}" method="POST">
			<input type="hidden" name="member_id" value="{{ m.id }}"/>
			<input type="hidden" name="action" value="edit"/>
			{% csrf_token %}

			<tr>
				<td>{{ m.user.get_full_name }}</td>
				<td>{{ m.title|default:"" }}</td>
				<td>{{ m.start_date }}</td>
				<td>{{ m.end_date|default:"" }}</td>
				<td>{{ m.is_lead }}</td>
				<td>{{ m.is_admin }}</td>
				<td>{{ m.is_active }}</td>
				<td>
					<input type="submit" value="Edit"/>
				</td>
			</tr>
		</form>
	{% endfor %}
	<form id="org_mem_add" action="{% url 'member_org_member' organization.id %}" method="POST">
		<input type="hidden" name="action" value="add"/>
		{% csrf_token %}
		<tr>
			<td colspan="7"></td>
			<td>
				<input type="submit" value="Add"/>
			</td>
		</tr>
	</form>
</table>

<h3>Notes</h3>
<ul>
	{% for n in organization.notes %}
		<li>{{ n.created_ts }} {{ n.created_by }}: {{ n.note }}</li>
	{% endfor %}
</ul>

{% endblock %}
