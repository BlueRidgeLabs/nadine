{% load static %}

<h5>Details</h5>
<table class='mem-details-table'>
  <tr class='row-even'>
    <th class='sub-th'>Billing Day</th>
    <th class='sub-th'>Next Bill</th>
    <th class='sub-th'>Package</th>
    <th class='sub-th'></th>
  </tr>
  <tr>
    <td>{{ membership.bill_day_str }}</td>
    <td>{{ membership.next_period_start }}</td>
    <td>{{ membership.package }}</td>
    <td>
      <!-- Doesn't work:  Must be a POST -->
      <a class='chip' href="?gen_bill">Regenerate Bill</a>
      <a class='chip' href="{% url 'staff:members:membership' user.username %}">Edit Membership</a>
    </td>
  </tr>
</table>

<h5>Subscriptions</h5>
<table class='sub-table'>
  <tr>
    <th class='sub-th'>Resource</th>
    <th class='sub-th'>Allowance</th>
    <th class='sub-th'>Start Date</th>
    <th class='sub-th'>End Date</th>
    <th class='sub-th'>Overage</th>
    <th class='sub-th'>Monthly</th>
    <th class='sub-th'>Paid By</th>
  </tr>
  {% for s in membership.active_subscriptions %}
    <tr class='{% cycle "row-odd" "row-even" %}'>
      <td>{{ s.resource }}</td>
      <td>{{ s.allowance }}</td>
      <td>{{ s.start_date }}</td>
      <td>{{ s.end_date |default:"-" }}</td>
      <td>${{ s.overage_rate }}</td>
      <td>${{ s.monthly_rate }}/month</td>
      <td>{{ s.paid_by|default:"" }}</td>
    </tr>
  {% endfor %}
  <tr>
    <td colspan="5"><strong>Total:</strong></td>
    <td>${{ membership.monthly_rate }}/month<td>
  </tr>
</table>

<!-- Active Guest Memberships -->
<!-- TODO This is the old way... needs to be ported to the new way -->
<!--
{% if user.profile.guests %}
  <h5>Active Guests:</h5>
    <table>
      <tr>
        <th>Name</th>
        <th>Membership</th>
        <th>First Visit</th>
      </tr>

      {% for guest in user.profile.guests %}
        <tr class="{% cycle 'row-even' 'row-odd' %}">
          <td nowrap><a href="{% url 'staff:members:detail' guest.username %}">{{ guest.get_full_name }}</a></td>
          <td>{{ guest.profile.active_membership.membership_plan }}</td>
          <td class='centered'>{{ guest.profile.first_visit }}</td>
        </tr>
      {% endfor %}
    </table>
{% endif %}
-->
