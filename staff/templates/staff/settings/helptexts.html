{% extends "staff/settings/base.html" %}

{% block content %}
<h4>Add and Update Help Texts</h4>

<div class='other-helps'>
  <table>
    <tr>
      <td class='td-title'></td>
      <td>
        <form class='text-selection' method='GET' action='.'>
          <select id='help-input' name='selected_help'>
              <option value='Select One' selected disabled="True">Select One to Update</option>
            {% for help in helps %}
              <option value='{{ help.title }}'>{{ help.title }}</option>
            {% endfor %}
          </select>
          <input style='display: inline-block;' class='btn' type='submit' value='Select' />
        </form>
      </td>
    </tr>
  </table>
</div>

<div class='helptext-form'>
  <form method='POST' action='.'>
    <table>
      <tr class='order-row'>
        <td class='td-title'></td>
        <td>
          {{ helptext_form.order }}
        </td>
      </tr>
      <tr>
        <td class='td-title'><strong>Title</strong></td>
        <td>
          {{ helptext_form.title}}
        </td>
      </tr>
      <tr>
        <td class='td-title'><strong>Template</strong> (<a onclick="$('#template_help').toggle();">?</a>)</td>
          <input name='id' id='text-id' type='hidden' value='{{ selected.id }}' />
          <td>
            {% if selected %}
              <textarea name='template' id='id_template' rows='20'>
                {{ selected.template|safe }}
              </textarea>
            {% else %}
                {{ helptext_form.template }}
            {% endif %}
          </td>
      </tr>
      <tr class='preview-tr'>
        <td><strong>Preview</strong></td>
        <td>
          <div id='preview'></div>
        </td>
      </tr>
    </table>
    <table id='template_help'>
      <tr>
        <td>
          <strong>Template Help</strong>
          <p>
            The template is that which will be entered in the help text page template. This editor will help you make sure it is styled just right. It is important to note, the title of the template will appear on the help page as a 'Heading 1' so make sure everything is smaller than that.
          </p>
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td class='td-title'><strong>URL Slug</strong>(<a onclick="$('#slug_help').toggle();">?</a>)</td>
        <td>
          {{ helptext_form.slug }}
        </td>
      </tr>
    </table>
    <table id='slug_help'>
      <tr>
        <td>
          <strong>What is a 'slug'?</strong>
          <p>
            The slug is the exact address for the help text post. In this case, you'll be able to find your help text at /member/help/YOUR_SLUG/. Make sure to not include any whitespaces.
          </p>
        </td>
      </tr>
    </table>
    {% csrf_token %}
    <button type='submit' class='btn help-btn'>Submit</button>
  </form>
</div>
<script>
  $(document).ready(function() {
    $('.button-collapse').sideNav();
    $('.collapsible').collapsible();
    $('#id_order').val('{{ latest_order }}');

    CKEDITOR.replace('id_template');

    if('{{ selected }}' != 'None') {
      //How can we have them update the template? Currently getting an error
      $('#id_title').val('{{ selected.title }}');
      $('#id_slug').val('{{ selected.slug }}');
      $('#id_order').val('{{ selected.order}}');
    }
  });
</script>
{% endblock %}
